<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BED Calculator with Tumor Proliferation</title>
    <h1>
      Tính liều hiệu dụng sinh học 
    </h1>
    <h2>
      <subtitle>Dành cho cả trường hợp xét và không xét đến tái sinh nhanh</subtitle>
    </h2>
      <style>
        body {
            font-family: Times New Roman, sans-serif;
            text-align: center;
            margin: 60px;
        }

        #calculator {
            width: 400px;
            margin: 0 auto;
        }

        label {
            display: inline-block;
            text-align: left;
            width: 200px;
        }

        input, button {
            width: 150px;
            height: 30px;
            margin: 5px;
            font-size: 14px;
        }

        #result {
            width: 300px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
<div>
  <form id="bedForm">
    <div>
      <label for="n">Số phân liều (lần):</label>
      <input type="number" id="n" required>
    </div>
    <br>

    <div>
      <label for="d">Liều (Gy):</label>
      <input type="number" id="d" required>
    </div>
    <br>

    <div>
        <label for="alphabetaRatio">Tỉ số Alpha/Beta (α/β):</label>
         <div class="input-group">
            <input type="range" id="alphabetaRatio" min="1" max="16" step="0.1" value="1" oninput="updateSliderValue1()">
            <input type="text" class="form-control input-lg" id="alphabetaValue" oninput="updateSliderFromInput1()">
        </div>
    </div>
    <br>

    <div>
      <label for="proliferationConstant">Hệ số tái sinh nhanh (K):</label>
         <div class="input-group">
            <input type="range" id="proliferationConstant" min="0" max="1" step="0.1" value="2" oninput="updateSliderValue()">
            <input type="text" class="form-control input-lg" id="proliferationValue" oninput="updateSliderFromInput()">
        </div>
    </div>
    <br>
    
    <div>
      <label for="T">Thời gian xạ trị (ngày) (T):</label>
      <input type="number" id="T" required>
    </div>
    <br>

    <div>
      <label for="Tdelay">Thời gian bắt đầu tái sinh nhanh tính từ lúc xạ (ngày):</label>
      <input type="number" id="Tdelay" required>
    </div>
    <br>

    <button type="button" onclick="calculateBED()">Calculate BED</button>
  </form></div>


<p id="result"></p>

<script>
    function updateSliderValue1() {
        var slider1 = document.getElementById('alphabetaRatio');
        var valueDisplay1 = document.getElementById('alphabetaValue');
        valueDisplay1.value = slider1.value;
    }

    function updateSliderFromInput1() {
        var slider1 = document.getElementById('alphabetaRatio');
        var valueDisplay1 = document.getElementById('alphabetaValue');

        if (parseFloat(valueDisplay.value) >= 1 && parseFloat(valueDisplay1.value) <= 16) {
            slider1.value = valueDisplay1.value;
        } else {
            alert('Tỉ số Alpha/Beta phải nằm trong khoảng 1 tới 16.');
        }
    }
    function updateSliderValue() {
        var slider = document.getElementById('proliferationConstant');
        var valueDisplay = document.getElementById('proliferationValue');
        valueDisplay.value = slider.value;
    }

    function updateSliderFromInput() {
        var slider = document.getElementById('proliferationConstant');
        var valueDisplay = document.getElementById('proliferationValue');

        if (parseFloat(valueDisplay.value) >= 0 && parseFloat(valueDisplay.value) <= 1) {
            slider.value = valueDisplay.value;
        } else {
            alert('Hệ số tái sinh nhanh phải nằm trong khoảng 0 tới 1.');
        }
    }
    function calculateBED() {
        const n = parseFloat(document.getElementById('n').value);
        const d = parseFloat(document.getElementById('d').value);
        const alphabetaRatio = parseFloat(document.getElementById('alphabetaRatio').value);
        const T = parseFloat(document.getElementById('T').value);
        const Tdelay = parseFloat(document.getElementById('Tdelay').value);
        const K = parseFloat(document.getElementById('proliferationConstant').value);
        
        if (alphabetaRatio < 1 || alphabetaRatio > 16) {
            alert('Giá trị của alpha/beta phải nằm trong khoảng 0 đến 16.');
            return;
        }

        const BED = n * d * (1 + d / alphabetaRatio) - K * (T - Tdelay);

        document.getElementById('result').innerHTML = 'Biologically Effective Dose (BED): ' + BED.toFixed(2);
    }
</script>

</body>
</html>
